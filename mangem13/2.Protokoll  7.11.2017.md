# Protokoll 2 7.11.2017 - Atmel Studio  

Schriftführer: Gerhard Mandl  
Betreuer: Sx  
Gruppe: 2 
Abwesend: Niemand  
Anwesend: Nebel Florian, Mandl Gerhard, Mörth Michael, Martinak Moritz, Nabernik Mario, 
Köhler Marcel, Lorenz Muri, Platzer Andreas  

## Inhaltsangabe:
    1. Atmel Studio - Erklärung
    2. CPU - Aufbau  
    3. Atmega 328p
    4. Wichtigsten Register
    5. SRAM Aufbau 
    6. Übung
    7. Bekannteste Maschinenbefehle

## Atmel Studio - Erklärung
Atmel Studi ist eine Entwicklungaumgebung und wurde von der Firma Atmel erschaffen, welche es ermöglicht Microcontroller von der Familie Atmel zu programmieren.  Dieses Programms kann dann auch Simulieren.

Durch die Simulation ist es möglich, genauere Informationen des Programmes zu erhalten.  Es werden Maschinenbefehle und Register ausgegeben.

## CPU - Aufbau
![CPU](https://github.com/HTLMechatronics/m14-la1-sx/blob/moemim14/moemim14/CPU.PNG)
  
## Atmega 328p
In dem Programm Atmel Studio muss man zuerst angeben welchen Microkontrolle r man verwendet da es unseren **Atmega328p** nicht gibt nehmen wir den **Atmega328** da diesee unserem sehr ähnlich ist.  

**Technische Daten zum Atmega 328p**
* 16 Mhz 
* 32 kb Flash
* 32 Register
* 1 kb  EEPROM
* 2 kb SRAM

## Wichtigsten Register
Der Atmega hat 32 Register unter diesen gibt es die **X,Y,Z Register**. Dieser werden dazu verwendet Werte zu speichern die Größer als 255 sind. Diese Register setzten sich wie folgt zusammen:
* X-Register 26-27
* Y-Register 28-29
* Z-Register 30-31

**Weitere Register**  
**SREG**= Statusflegregister  
**SPH** = Stackpointer  
**SPL** = Stackpointer  

* SPL initialisiert Register 7-15
* SPH initialisiert Register 0-7

## SRAM Aufbau
![SRAM](https://github.com/HTLMechatronics/m14-la1-sx/blob/mangem13/mangem13/SRAM_Aufbau.PNG)

### .data
Im Data werden die globalen Variablen gespeichert.

### Der Heap
Der Heap ist für die dynamische Speicherverwaltung. Wenn der Heap größer wird greift er auf den freien Speicher zu.

### Freier Speicher
Der freier Speicher wird enteder vom Heap oder vom Stack benutzt oder auch beiden. Falls der freie Speicher aus geht, bekommt man eine Fehlermeldung "Stackoverflow", dies muss aber nichtg sein.

### Der Stack
Der Stack ist ein Stapelspeicher, der nach dem "Last in first out" Prinzip. 
Der Stack ist außerdem ein Teil vom SRAM. Im Stack werden z.B. lokale Variablen gespeichert. Wenn der Stack mehr Speicher braucht greift er auf den freien Speicher zu.

## Übung
```c
int main()
{
  return 0;
}
```
Diesr Code wird simuliert, Atmel Studi liefert uns dann Maschinenbefehle, welche aus dem Quellcode kompiliert werden.  
[Atmel Instruction Set Manual](http://www.atmel.com/images/Atmel-0856-AVR-Instruction-Set-Manual.pdf) dieses Skript hilft uns die Maschinenbefehle zu verstehen. Jedoch muss man darauf achten das man seinen Atmega auswählt da es von Atmega zu Atmega anderst ist.

## Bekanntesete Maschinenbefehle
* RJMP: Sprung zu einer Adresse
* RCALL: Sprung zu einer Adresse, wo die Rücksprungs Adresse am Stack gespeichert wird.
* CLR R..: Setzt bestimmtes Register auf 0
* OUT 0x3F R1: Ladet die Daten von Register R1 in ein I/O Register
* LDI R1, 0x08: Ladet einen Konstanten Wert in das Register 1 rein.
