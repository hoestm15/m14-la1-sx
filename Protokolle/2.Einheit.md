# 2.Protokoll
## Thema: Atmel Studio

Datum 17.10.2017
Abwesend: Niemand

AtmelStudio ist eine IDE für die Programmierung und Simulation dieser Programme der Atmel Microcontroller, womit man auch Einblicke in die Register der Microcontroller bekommt. 
Es ist reinewegs nur auf Windows lauffähig, jedoch gibt es Alternativen, die auch auf anderen Betriebssystemen funktionieren, wie z.B.: [NetBeans](https://netbeans.org) oder [Arduino](https://www.arduino.cc).

## CPU Aufbau

Wir haben auch die [CPU](https://lms.at/mybib/MTE3NTEwNjAz/bibs/dotlrn_class_instance/xolrn__237409696.symlink/EC743ABCF7AB5.symlink?resource_id=0-120562156-120562159-237409900-237409759&m=view#188315330), die wir auch in Fivu besprochen hatten, nochmal genau angeschaut.

## ATmega328p

Wir machten eine Atmelprogrammübung mit dem [ATmega328p](http://www.atmel.com/Images/Atmel-42735-8-bit-AVR-Microcontroller-ATmega328-328P_Datasheet.pdf). In dem wir folgendes C-Programm schrieben, und die genauen Abläufe, was im Prozessor passierten genau durchgingen

*int main()
{
return 0;
};*

Im Prozessor wurden dann folgende Befehle, die wir dann aus der [AVR Instruction Set Manual](http://www.atmel.com/images/Atmel-0856-AVR-Instruction-Set-Manual.pdf) raussuchten und genua durchgingen.

* RJMP -> springt auf die angegebene Adresse
* CLR R1 -> Das Register wird 0 gesetzt
* OUT 0x3f, R1 -> Inhalt vom R1 wird ins I/O 0x3f kopiert
* SREG -> alle Statusbits werden zurückgesetzt
* SER R28 -> setzt das R28 auf 0xFF
* CDI R29, 0x08 -> setzt R29 auf 0x08, das Y-Register ist nun auf dem Wert 0xFF08
* OUT 0x3E, R29 und OUT 0x3D, R29 -> Stackpointer wird auf das Y-Register gesetzt

## Stack

Der [Stack](https://lms.at/mybib/MTE3NTEwNjAz/bibs/dotlrn_class_instance/xolrn__237409696.symlink/EC743ABCF7AB5.symlink?resource_id=0-120562156-120562159-237409900-237409759&m=view#189566980) arbeitet mit dem Stapelprinzip, dass heißt er speichert von unten nach oben, kann aber dann auch nur von oben nach unten den Speicher auslesen. Wenn man zu viel Stackspeicher verwendet, kommt es zu einem Stack Overflow.

Man hat 3 Befehle um mit dem Stack zu arbeiten

* push -> Die Daten werden auf die Adresse gespeichert auf der der Stackpointer zeigt
* pop -> Der Stackpointer geht auf die nächsthöhere Adresse und ließt diese Adresse aus und hebt sie vom Stack
* peek -> ließt die nächsthöhere Adresse nur aus, ohne sie vom Stack zu heben
