# Protokoll 3

Datum: 3.12.2018
Anwesend: Berger Emil, Bullner Jeremy, Ehmann Julian, Köhler Marcel
Abwesend: Böcksteiner Jakob, Kobor Markus 

## Node.js und Express.js

Node.js ist eine serverseitige JavaScript-Laufzeitumgebung für die Realisierung von Webservern. 
Express.js ist Erweiterungsmodul für Node.js, welches die HTTP/HTTPS-Serverprogrammierung einfacher gestalten soll. Dieses muss mithilfe der Befehle `npm install express` und `npm install --save-dev @types/express` installiert und auf Typescript umgestellt werden.

## HTTP

[HTTP](https://de.wikipedia.org/wiki/Hypertext_Transfer_Protocol)(=Hypertext Transfer Protocol) ist ein zustandsloses, Übertragungsprotokoll auf dem Application Layer in einem Netzwerk, welches die Daten textuell überträgt.
Meist wird es für Anfragen im WWW (Port 80) verwendet, um von dort Daten in den Webbrowser zu laden.
Es arbeitet nach dem Server-Client-Prinzip.

HTTP-Requestbefehle:
 
 * GET (Anforderung von Daten)
 * POST (Versenden von Daten)
 * PUT (Hochladen von Daten)
 * DELETE (Löschen von Daten)

## HTTP-Informationsübertragung

Man kann Informationen entweder über die URL oder den Body senden. Für beide Arten benötigt man den sogennanten *Body-Parser*
Der Body-Parser ist eine Zwischenanwendung, welche die Requestdaten für den Server aus dem Requeststrom ausliest und bereitstellt.
Dieser muss mit den Befehlen `npm install body-parser`und `npm install --save-dev @types/body-parser`installiert werden und im Server mit dem Befehl `this._server.use(bodyParser.function())` festgelegt werden.

### URL

Mittels ? am Ende der eigentlichen URL kann man ,von der URL getrennt, weitere Informationen versenden. Für weitere Parameter hängt man ein & an. Da die gesamte URL jedoch im Browserverlauf gespeichert wird, ist diese Form der Übertragung für wichtige/geheime Daten nicht zum Empfehlen.

Im Konstruktor wird mit dem Befehl `this._server.use(bodyParser.urlencoded())`festgelegt, dass die Informationen aus der URL zu lesen sind.


### Body

Mittels HTTP-Request PUT kann man Informationen dem Request anfügen.

Um nun Informationen im JSON-Format übermittlen zu können muss man folgende Befehle im Konstruktor eintragen: ``this._server.use(bodyParser.json()); // Legt fest, dass die Daten in JSON-Codierung vershcikt werden

this._server.put('/data', (req, res) => this.handlePutData(req, res));``

Sowie eine Handler-Methode in data geschrieben werden:

``private handlePutData(req: express.Request, res: express.Response) 
{
        try 
        {
            const m = new Value(req.body.temp, req.body.power);  // Daten werden Abgerufen und in Variablen gespeichert
            Database.getInstance().add(m);                       // Daten werden in eine neue Instanz am Server gespeichert
            res.send({id: Database.getInstance().size() - 1});
        } 
        catch (err) 
        {
            res.status(400).send('Bad Request');
        }
    }``
### Rested

Mithilfe des Firefox-AddOns RESTed kann man HTTP-Requeste versenden, Informationen senden und die Responces auslesen.
