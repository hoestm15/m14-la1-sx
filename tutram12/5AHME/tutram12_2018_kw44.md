# *2. Laborprotokoll*

  Name: Raphael Tuttner   
  Klasse: 5AHME   
  Datum: 22.10.2018   
  Anwesend: Strauß Lukas, Strutz Sebastian, Tuttner Raphael, Uhl Christian, Wieser Markus, Zitz Karlheinz    
  Abwesend: Waltl Kilian  
  
  # Typescript

## Statuscodes

Als aller Erstes haben wir nochmals Statuscodes besprochen. Das sind die Codes, die man von einem Server erhalten kann.

Sieht der Code z.B. so aus: 2XX, kann man von einer erfolgreichen Operation ausgehen, sieht er jedoch so aus: 4XX, geht man von einem Client Fehler aus.

400 -> Bad Request
403 -> Forbidden (Mangelnde Berechtigung)

## Typescript: Dateien

In der vorherigen Einheit haben wir die nötigen Dateien für einen private ReST-Server vom Mechatronik-Server gedownloadet.

Dateien und respektive Anwendungszwecke:

* src: Verzeichnis, welches die Quelltextdateien beinhaltet

* .vscode: Verzeichnis, welches die Konfigurationsdateien beinhaltet:

    * keybindings.json: Hier lassen sich verschiedene Tastenkombinationen, welche das Programmieren in der Entwicklungsumgebung erleichtern einrichten
    
    * launch.json: Hier wird das Startverhalten von Programmen eingestellt
    
    * settings.json:  Konfigurations-Datei, mit welcher man die Benutzeroberfläche teiweise einstellen kann 
    
    * tasks.json: Hier wird Gulp aufgerufen.
    
* package.json: Projektinfos & Abhängigkeiten

* gulpfile.js: Hier wird die Steuerung der Übersetzung festgelegt. (make in C, gradle in Android Studio, ant in Netbeans)

* tslint.json: Hier wird die Design-Überprüfung für den Quelltext bestimmt. (Vor allem in Firmen sehr wichtig)

* tsconfig.json:  Hier wird durch einen Transpiler aus einer Typescriptdatei eine Javascriptdatei erstellt.

# Visual Studio Code

Visual Studio Code ist der freie Quelltext-Editor von Microsoft. Er ist Plattformübergreifend verfügbar.

![Umgebung vs](https://github.com/HTLMechatronics/m14-la1-sx/blob/tutram12/tutram12/5AHME/umgebung_vs.png)  

## Visual Studio Code Icons

![Icons](https://github.com/HTLMechatronics/m14-la1-sx/blob/tutram12/tutram12/5AHME/Icons.png)

1. File explorer

2. Suchleiste

3. Versionsverwaltung (wie zum Beispiel GIT)

4. Debugger

5. Extensions (Erweiterungen)

6. Einstellungen (ganz links unten/am Bild nicht sichtbar)

# Programm
Wir erstellten zusätzlich zur Klasse **Main.ts** die Klasse **Server.ts**. Dieser Server soll auf eine Anfrage warten und mit Hallo antworten.

```  
import * as express from 'express';
import * as bodyParser from 'body-parser';

export class Server
{
    private port: number;
    private server: express.Express;
    constructor(port: number)
    {
        this.port = port;
        this.server = express();
        this.server.get('*', (req, resp) => this.handleGet(req, resp));
        this.server.listen(this.port);
    }
    
    private handleGet(req: express.RequestHandler, resp:express.Response)
    {
        resp.send('Hallo');
        resp.end;
    }
}
```  
Danach erweiterten wir unser Programm.
Es soll nun auf verschiedene Anfragen verschieden reagieren zu können.

```  
import * as express from 'express';
import * as bodyParser from 'body-parser';

export class Server
{

    private _server: express.Express;
    constructor (port: number)
    {
        this._server = express();
        // this._server.get('/student', this.handleGetStudent.bind(this));
        this._server.use(bodyParser.urlencoded({ extended: false}));
        this._server.get('/student', (req, resp, next) => this.handleGetStudent(req, resp, next)); 
        this._server.listen(port);
        console.log('HTTP Server gestartet auf Port' + port);
    }

    private handleGetStudent (req: express.Request, resp: express.Response, next: express.NextFunction) 
    {
        console.log(req.body.query.htlid);
        switch (req.query.htlid)
        {
            case 'tutram12':
                resp.json({ surname: 'Tuttner', firstname: 'Raphael'});
                break;
            case 'zitkam13':
                resp.json({ surname: 'Zitz', firstname: 'Karl-Heinz'});
                break;
            default:
                resp.status(404);
        }
        resp.send('Antwort' + req.query.htlid);
    }
}
```  
